<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processos | Acompanhe seu processso</title>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="assets/css/custom.css">

    <!-- <link href="/assets/fontawesome-free-6.6.0-web/css/fontawesome.css" rel="stylesheet" /> -->
    <link href="assets/fontawesome-free-6.6.0-web/css/all.css" rel="stylesheet" />


    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"> -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <link href="https://cdn.datatables.net/v/bs5/dt-2.1.8/r-3.0.3/sb-1.8.1/datatables.min.css" rel="stylesheet">
 
    <script src="https://cdn.datatables.net/v/bs5/dt-2.1.8/r-3.0.3/sb-1.8.1/datatables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/fixedcolumns/4.3.0/js/dataTables.fixedColumns.min.js"></script> -->


    <link href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/fixedcolumns/5.0.4/css/fixedColumns.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/responsive/3.0.3/css/responsive.bootstrap5.min.css" rel="stylesheet">

    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/dataTables.fixedColumns.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/3.0.3/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/3.0.3/js/responsive.bootstrap5.js"></script>

</head>

<body class="d-flex flex-column min-vh-100">

    <div class="content-wrapper">
        <!-- Menu -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-black mb-5">
            <div class="container">
                <a class="navbar-brand" href="#"><img src="assets/svg/logo_asp.svg" alt="" width="275" height="30"></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link text-white" href="#">Dashboard</a></li>
                        <li class="nav-item"><a class="nav-link text-white" href="#">Planos</a></li>
                        <li class="nav-item"><a class="nav-link text-white" href="#">Processos</a></li>
                        <li class="nav-item"><a class="nav-link text-white" href="#">Contato</a></li>
                        <li class="nav-item dropdown">
                            <a class="nav-link" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown"
                                aria-expanded="false">
                                <img src="https://i.pinimg.com/originals/05/51/f5/0551f506725ac1deeaa85d46f8b9a5fd.jpg"
                                    alt="Profile" class="rounded-circle" width="30" height="30">
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                                <li><a class="dropdown-item" href="#">Perfil</a></li>
                                <li><a class="dropdown-item" href="#">Sair</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Alertas -->
        <div class="container my-3 mb-5">
            <div class="alert alert-primary alert-dismissible fade show py-1" role="alert" style="font-size: 0.875rem;">
                <button type="button" class="btn-close btn-sm" style="top: -12px;" data-bs-dismiss="alert"
                    aria-label="Close"></button>
                <strong>Atenção</strong>: Seu periodo de teste expira em 11 dias.
            </div>
        </div>

        <div class="container mb-3">
            <h2> Processos</h2>
        </div>

        <!-- Conteúdo -->
        <div class="container bg-white rounded-4 shadow-sm">
            <div class="row">
                <!-- Sidebar -->
                <div class="col-lg-2 col-md-3 col-12 my-3 mt-5 border-right">
                    <div class="nav flex-column nav-pills" role="tablist" aria-orientation="vertical">
                        <a class="nav-link text-black" href="processos_1.html">Cadastro de processos</a>
                        <div class="ms-3">
                            <a class="nav-link text-muted" href="#">Manual</a>
                            <a class="nav-link text-muted" href="processos_4_copie_cole.html">Copie e Cole</a>
                        </div>
                        <a class="nav-link active" href="#"><strong>Gerenciador de processos</strong></a>
                        <a class="nav-link text-black" href="processos_6_painel.html">Painel de processos</a>
                        <a class="nav-link text-black" href="processos_7_movimentacoes.html">Filtrar movimentações</a>
                    </div>
                </div>

                <div class="col-lg-10 col-md-9 col-12 p-5">




                    <div class="row col-12 m-3 ms-auto p-3 position-relative align-items-start" id="profile-edit">



                        <div
                            class="col-lg-12 col-md-12 col-12 d-flex align-items-center justify-content-start mb-3 mb-md-0 ">
                            <div class="w-100">
                                <div class="row">
                                    <div class="col-12 col-lg-5 col-sm-12">
                                        <div class="row pe-2">
                                            <div class="col-12 mt-4 mb-3">
                                                <h5>Gerenciador de Processos</h5>
                                            </div>
                                            <div class="col-12 col-lg-8 col-sm-12 mt-5">
                                                <input type="search" class="form-control me-2"
                                                        placeholder="Buscar processo" name="search" id="search">
    
                                            </div>
                                            <div class="col-12 col-lg-4 col-sm-12 mt-5">
                                                <button class="btn btn-light" id="search_button" style="width: 100%;">Buscar</button>
                                            </div>

                                        </div>
                                        
                                            
                                        
                                    </div>
                                    <div class="col-12 col-lg-7 col-sm-12 rounded-4 border align-items-start p-4 mt-3">
                                        <div class="row">
                                            <div class="col col-12 col-md-6 col-lg-6">
                                                <div class="row">
                                                    <div>
                                                        <small>Plano </small><span style="color: green; font-size: 1.3rem;">Teste
                                                            Gratis</span>
                                                    </div>

                                                </div>
                                                <div class="row mt-3">
                                                    <small>Cotas de processos</small>
                                                </div>

                                            </div>

                                            <div class="col col-12 col-md-6 col-lg-6">
                                                <div>
                                                    Precisa de mais cotas? <a href="#" class="btn btn-light"
                                                        style="border-color: #F15921; color: #F15921;">Clique aqui</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row mt-4">
                                            <div class="progress">
                                                <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                    role="progressbar" style="width: 64%;" aria-valuenow="96"
                                                    aria-valuemin="0" aria-valuemax="150">
                                                    96 de 150
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                
                                
                                    <div class="col-12 col-lg-4 col-sm-12 pt-4">
                                        <label for="filtro_status">Status</label>
                                        <select name="filtro_status" class="form-control" id="filtro_status">
                                            <option value="Todos" selected>Todos</option>
                                            <option value="Ativo">Ativo</option>
                                            <option value="Atualizando">Atualizando</option>
                                            <option value="Manutenção">Manutenção</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-lg-4 col-sm-12 pt-4">
                                        <label for="filtro_origem">Origem</label>
                                        <select name="filtro_origem" class="form-control" id="filtro_origem">
                                            <option value="Todos" selected>Todos</option>
                                            <option value="Ativo">Ativo</option>
                                            <option value="Atualizando">Atualizando</option>
                                            <option value="Manutenção">Manutenção</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-lg-4 col-sm-12 pt-4">
                                        <label for="filtro_tribunal">Tribunal</label>
                                        <select name="filtro_tribunal" class="form-control" id="filtro_tribunal">
                                            <option value="Todos" selected>Todos</option>
                                            <option value="Ativo">Ativo</option>
                                            <option value="Atualizando">Atualizando</option>
                                            <option value="Manutenção">Manutenção</option>
                                        </select>
                                    </div>
                                
                                
                                    <div class="col-12 pt-4">
                                        <button class="btn btn-light" id="excluir" style="width: auto;">Excluir <i
                                                class="fa-regular fa-trash-can"></i></button>


                                    </div>

                                </div>
                                <div class="row mt-5" style="font-size: 0.8rem;">
                                    <div class="col col-12">
                                        <div class="table-responsive">
                                            <table id="processTable" class="table">
                                                <thead class="table-secondary">
                                                    <tr>
                                                        <th></th>
                                                        <th id="tribunal">Tribunal</th>
                                                        <th id="processo">Processo</th>
                                                        <th id="monitoracao">Monitoração</th>
                                                        <th id="status">Status</th>
                                                        <th id="origem">Origem</th>
                                                        <th id="ultima_atualizacao" style="white-space: nowrap;">Última Atualização</th>
                                                        <th id="ultimo_andamento" style="white-space: nowrap;">Último Andamento</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><input type="checkbox" id="selectProcess"
                                                                name="selectProcess"></td>
                                                        <td>TJSC</td>
                                                        <td>0000001-02.2019.8.24.0000</td>
                                                        <td>
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="monitoringSwitch1" checked>
                                                                <label class="form-check-label"
                                                                    for="monitoringSwitch1"></label>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span class="badge rounded-pill bg-primary">Ativo</span>
                                                        </td>
                                                        <td><img src="assets/img/manual.png" alt="Manual Icon"
                                                                width="20" height="20">Manual</td>
                                                        <td>05/09/2024 - 00:00</td>
                                                        <td>05/09/2024 - 00:00</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" id="selectProcess"
                                                                name="selectProcess"></td>
                                                        <td>TJSC</td>
                                                        <td>0000001-02.2019.9.24.0000</td>
                                                        <td>
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="monitoringSwitch1">
                                                                <label class="form-check-label"
                                                                    for="monitoringSwitch1"></label>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span
                                                                class="badge rounded-pill bg-warning">Atualizando</span>
                                                        </td>
                                                        <td><img src="assets/img/manual.png" alt="Manual Icon"
                                                                width="20" height="20">Manual</td>
                                                        <td>05/09/2024 - 00:00</td>
                                                        <td>05/09/2024 - 00:00</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input type="checkbox" id="selectProcess"
                                                                name="selectProcess"></td>
                                                        <td>TJSC</td>
                                                        <td>0000001-02.2019.9.24.0000</td>
                                                        <td>
                                                            <div class="form-check form-switch">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="monitoringSwitch1">
                                                                <label class="form-check-label"
                                                                    for="monitoringSwitch1"></label>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span class="badge rounded-pill bg-danger">Manutenção</span>
                                                        </td>
                                                        <td><img src="assets/img/manual.png" alt="Manual Icon"
                                                                width="20" height="20">Manual</td>
                                                        <td>05/09/2024 - 00:00</td>
                                                        <td>05/09/2024 - 00:00</td>
                                                    </tr>

                                                </tbody>
                                            </table>
                                        </div>

                                    </div>


                                    <script>
                                        $(document).ready(function () {
                                            // Initialize DataTable
                                            var search = $('#search').val();
                                            var status = $('#filtro_status').val();
                                            var origem = $('#filtro_origem').val();
                                            var tribunal = $('#filtro_tribunal').val();



                                            var table = $('#processTable').DataTable({
                                                serverSide: true,
                                                searching: false,
                                                lengthChange: false,
                                                responsive: true,

                                                responsive: {
                                                    details: {
                                                        // display: $.fn.dataTable.Responsive.display.childRowImmediate,
                                                        // type: ''
                                                    },
                                                    breakpoints: [
                                                        { name: 'desktop', width: Infinity },
                                                        { name: 'tablet', width: 1024 },
                                                        { name: 'fablet', width: 768 },
                                                        { name: 'phone', width: 480 }
                                                    ],
                                                    columns: [
                                                        { responsivePriority: 1, targets: 0 },
                                                        { responsivePriority: 2, targets: 2 }
                                                    ]
                                                },

                                                columnDefs: [
                                                    {
                                                        orderable: false,
                                                        targets: '_all'  // Disables ordering for all columns
                                                    },
                                                    {
                                                        // Apply custom widths if the viewport width is detected as desktop size
                                                        targets: [0, 1, 2, 3, 4, 5, 6, 7],
                                                        createdCell: function (td, cellData, rowData, row, col) {
                                                            if (window.innerWidth >= 1024) {  // Desktop width condition
                                                                switch (col) {
                                                                    case 0: $(td).css('width', '50px'); break;
                                                                    case 1: $(td).css('width', '30px'); break;
                                                                    case 2: $(td).css({'width': '300px','white-space': 'nowrap'} ); break;
                                                                    case 3: $(td).css('width', '70px'); break;
                                                                    case 4: $(td).css('width', '100px'); break;
                                                                    case 5: $(td).css('width', '150px'); break;
                                                                    case 6: $(td).css('width', '150px'); break;
                                                                    case 7: $(td).css('width', '150px'); break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                ],

                                                ajax: {
                                                    url: 'assets/processos.json',
                                                    type: 'GET',
                                                    data: function (d) {
                                                        d.search = search;
                                                        d.status = status;
                                                        d.origem = origem;
                                                        d.tribunal = tribunal;
                                                        delete d.columns;
                                                    },
                                                    error: function (xhr, error, code) {
                                                        console.log("DataTables error:", error, code);
                                                        console.log("Response:", xhr.responseText);
                                                    }
                                                },

                                                language: {
                                                    url: "assets/js/datatables_pt_br.json"
                                                },

                                                columns: [
                                                    { data: null, render: function () { return '<input type="checkbox" id="selectProcess" name="selectProcess">'; } },
                                                    { data: 'tribunal' },
                                                    { data: 'processo' },
                                                    { data: 'monitoracao', render: function (data) { return '<div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="monitoringSwitch1" ' + (data ? 'checked' : '') + '><label class="form-check-label" for="monitoringSwitch1"></label></div>'; } },
                                                    { data: 'status', render: function (data) { return '<span class="badge rounded-pill bg-' + (data == 'Ativo' ? 'primary' : (data == 'Atualizando' ? 'warning' : 'danger')) + '">' + data + '</span>'; } },
                                                    { data: 'origem', render: function (data) { return '<img src="assets/img/' + (data === 'Manual' ? 'manual_mini' : 'automatico_mini') + '.png" alt="' + data + ' Icon" width="20" height="20">' + data; } },
                                                    { data: 'ultima_atualizacao', render: function (data) { var date = new Date(data); return date.toLocaleDateString('pt-BR') + ' - ' + date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' }); } },
                                                    { data: 'ultimo_andamento', render: function (data) { var date = new Date(data); return date.toLocaleDateString('pt-BR') + ' - ' + date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' }); } }
                                                ],

                                                pagingType: "simple_numbers",
                                                info: false,
                                                dom: "<'row'<'col-sm-12'tr>>" + "<'row'<'col-sm-12 d-flex justify-content-center mt-4 fw-bold'p>>"
                                            });







                                            // Search functionality
                                            $('#filtro_status, #filtro_origem, #filtro_tribunal').on('change keyup', function () {
                                                status = $('#filtro_status').val();
                                                origem = $('#filtro_origem').val();
                                                tribunal = $('#filtro_tribunal').val();
                                                table.ajax.reload();
                                            });

                                            $('#search_button').on('click', function () {
                                                search = $('#search').val();
                                                table.ajax.reload();
                                            });

                                            // Monitoracao switch change
                                            $('#processTable').on('change', '.form-check-input', function () {
                                                var processo = $(this).closest('tr').find('td:eq(1)').text();
                                                var isChecked = $(this).is(':checked');

                                                $.ajax({
                                                    url: 'assets/change_monitoracao.json',
                                                    method: 'GET',
                                                    data: {
                                                        processo: processo,
                                                        monitoracao: isChecked
                                                    },
                                                    success: function (response) {
                                                        alert('Monitoração atualizado com sucesso');
                                                        table.ajax.reload();
                                                    }
                                                });
                                            });

                                            // Delete selected processes
                                            $('#excluir').on('click', function () {
                                                if (confirm('Tem certeza que deseja apagar esses processos?')) {
                                                    var selected = [];
                                                    $('#processTable input[name="selectProcess"]:checked').each(function () {
                                                        selected.push($(this).closest('tr').find('td:eq(2)').text());
                                                    });

                                                    if (selected.length > 0) {
                                                        $.ajax({
                                                            url: '/delete_processos',
                                                            method: 'POST',
                                                            data: {
                                                                processos: selected
                                                            },
                                                            success: function (response) {
                                                                alert('Processos removidos com sucesso');
                                                                table.ajax.reload();
                                                            }
                                                        });
                                                    } else {
                                                        alert('Nenhum processo selecionado');
                                                    }
                                                }
                                            });
                                        });
                                    </script>

                                </div>



                            </div>

                        </div>




                    </div>


                </div>
            </div>
        </div>



    </div>


</body>
<!-- Footer -->
<footer class="bg-black text-white text-center py-3 mt-5">
    <div class="container d-flex justify-content-between">
        <p class="mb-0">© 2024 Agile Serviços. Todos os direitos reservados.</p>
        <div>
            <a href="#" class="text-white me-2"><i class="fa-brands fa-square-instagram"></i></a>
            <a href="#" class="text-white me-2"><i class="fa-brands fa-square-facebook"></i></a>
            <a href="#" class="text-white me-2"><i class="fa-brands fa-square-youtube"></i></a>
            <a href="#" class="text-white me-2"><i class="fa-brands fa-square-whatsapp"></i></a>

        </div>
    </div>
</footer>




</html>